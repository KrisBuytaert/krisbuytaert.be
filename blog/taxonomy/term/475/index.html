<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">


<!-- Mirrored from 127.0.0.1:8080/blog/taxonomy/term/475 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Sep 2017 19:42:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>heartbeat | Everything is a Freaking DNS problem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="alternate" type="application/rss+xml" title="RSS - heartbeat" href="0/feed/index.html" />
<link rel="shortcut icon" href="../../../misc/favicon/index.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/aggregator/aggregator/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/node/node/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/poll/poll/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/system/defaults/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/system/system/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/system/system-menus/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/user/user/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/all/modules/cck/theme/content-module/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/all/modules/date/date/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/all/modules/geshifilter/geshifilter/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../misc/farbtastic/farbtastic/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/all/modules/calendar/calendar/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/all/modules/cck/modules/fieldgroup/fieldgroup/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/all/modules/views/css/views/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../modules/taxonomy/taxonomy/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/default/themes/barlow/typography/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/default/themes/barlow/layout/index.css?9" />
<link type="text/css" rel="stylesheet" media="all" href="../../../sites/default/themes/barlow/style/index.css?9" />
<link type="text/css" rel="stylesheet" media="print" href="../../../sites/default/themes/barlow/print/index.css?9" />
</head>

<body class="not-front not-logged-in page-taxonomy one-sidebar sidebar-left">
<div id="wrapper">

<div id="header" class="p1">

  <div id="branding">
      <div id="logo">
    <a href="../../../index/index.html" title="Everything is a Freaking DNS problem" rel="home">
    <img src="../../../files/me_small/index.jpg" alt="Everything is a Freaking DNS problem" id="logo-image" />
    </a></div>
        <h1><a href="../../../index/index.html" title="Home" rel="home">Everything is a Freaking DNS problem</a></h1>
        <div class="slogan">Devops Needs Sushi</div>
    </div>

  
  <div class="skip"><a href="#content" title="Skip to site content" accesskey="2">Skip to content</a></div>

  
  <div id="menu">
      </div>
</div>

<div id="content">

  <div id="sidebar-left" class="sidebar">
  <div class="block block-block" id="block-block-5">
  <div class="content"><p>This is the blog where <a href="http://www.krisbuytaert.be/bio.shtml">Kris Buytaert</a> points you to extremely interresting and totally irrelevant stuff that happens in Life , The Universe and Everything</p>
<p>Questions, want to contact me please read my <a href="../../../faq/index/index.html">FAQ</a> and  <a href="../../../social/index/index.html">Social Media Policy</a></p>
<p>You can hire me! I work as a consultant for <a href="http://www.inuits.eu/">Inuits.eu</a></p>
</div>
</div>

  </div>

<div id="main">
  <div id="breadcrumb"><div class="breadcrumb"><a href="../../../index/index.html">Home</a></div></div>
  <h2 id="title">heartbeat</h2>
<div class="content">
<div id="node-1034" class="node teaser blog cal">
    <acronym class="calendar published" title="2011-02-10T20:20:44+01:00">
  <span class="month">Feb</span>
  <span class="day">10</span>
    <span class="year">2011</span>
    </acronym>
    <h2 class="title"><a href="../../../ensure-running/index.html">Ensure Running</a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_1328 first"><a href="../../../category/devops/index.html" rel="tag" title="">devops</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_562"><a href="../562/index.html" rel="tag" title="">linux-ha</a></li>
<li class="taxonomy_term_1438"><a href="../../../category/managed/index.html" rel="tag" title="">managed</a></li>
<li class="taxonomy_term_1436"><a href="../../../category/modules/index.html" rel="tag" title="">modules</a></li>
<li class="taxonomy_term_439"><a href="../439/index.html" rel="tag" title="">puppet</a></li>
<li class="taxonomy_term_1437 last"><a href="../../../category/unmanaged/index.html" rel="tag" title="">unmanaged</a></li>
</ul></span>
        </div>
  <div class="content"><p>Has anyone noticed that pretty much every puppet module one finds on the internet by default enables the service they try to configure in the module</p>
<p>When looking at it from a single machine point of view it makes sense to include the module , have it configure your service  and directly enable it by default.</p>
<p>So I started wondering .. isn't there anybody out there who is building clusters ?   Where services have to configured on multiple nodes but should NOT be running acitvely on all nodes by default because there is an external tool which manages that for you (Pacemaker framework eg.)</p>
<p>Agreed it's a small patch to get the functionality you want , but it brings an extra overhead when one upgrades the modules etc.</p>
<p>So if it doesn't bother you  please split your puppet module in 2 parts.. one you call to configure the service,  another which you call to enable the service , if you want to.</p>
<p>thnx !</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
<li class="comment_comments last"><a href="../../../ensure-running/index.html#comments" title="Jump to the first comment of this posting.">7 comments</a></li>
</ul></div>
</div>
<div id="node-1022" class="node teaser blog cal">
    <acronym class="calendar published" title="2010-11-04T00:07:18+01:00">
  <span class="month">Nov</span>
  <span class="day">04</span>
    <span class="year">2010</span>
    </acronym>
    <h2 class="title"><a href="../../../high-availability-mysql-cookbook-review/index.html">High Availability MySQL Cookbook , the review</a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_1430 first"><a href="../../../category/cobbler/index.html" rel="tag" title="">cobbler</a></li>
<li class="taxonomy_term_899"><a href="../899/index.html" rel="tag" title="">drbd</a></li>
<li class="taxonomy_term_449"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_562"><a href="../562/index.html" rel="tag" title="">linux-ha</a></li>
<li class="taxonomy_term_458"><a href="../458/index.html" rel="tag" title="">mysql</a></li>
<li class="taxonomy_term_1336"><a href="../../../category/pacemaker/index.html" rel="tag" title="">pacemaker</a></li>
<li class="taxonomy_term_439 last"><a href="../439/index.html" rel="tag" title="">puppet</a></li>
</ul></span>
        </div>
  <div class="content"><p>When I read on the internetz that Alex Davies was about the publish a <a href="https://www.packtpub.com/high-availability-mysql-cookbook/book" rel="nofollow">Packt book on MySQL HA</a>  I pinged my contacts at Packt and suggested that I'd review the book .</p>
<p>I've ran into <a href="https://sites.google.com/a/davz.net/alex-davies/" rel="nofollow">Alex</a> at some UKUUG conferences before and he's got a solid background on MySQL Cluster and other HA alternatives so I was looking forward to reading the book.</p>
<p>Alex starts of with a couple of indepth chapters on MySQL Cluster,  he does mention that it's not a fit for all problems, but I'd hoped he did it a bit more prominently ...    an upfront chapter outlining the different approaches and when which approach is a match could have been better.    The avid reader now might be 80 pages into MySQL cluster before he realizes it's not going to be a match for his problem.</p>
<p>I really loved the part where Alex correcly mentions that you should probably be using Puppet or so to manage the config files of your environment, rather than scp them around your different boxes ..</p>
<p>Alex then goes on to describe setting up MySQL replication and Multi Master replication with the different approaches one can take here,  he gives some nice tips on using LVM to reduce the downtime of your MySQL when having to transfer the dataset of an already existing MySQL setup, good stuff.</p>
<p>He then goes on to describe MySQL with shared storage ...   if you only mount your redundant sandisk once on your MySQL nodes my preference would probably be a Pacemaker stack  rather than a RedHat Cluster based setup,  but his setup seems to work too.   Alex quickly touches on using GFS to have your data disk mounted simultaneously on both nodes (keep in mind with only 1 active MySQLd)  and then goes on to describe a full DRBD based MySQL HA setup</p>
<p>The last chapter titled Performance tuning gives some very nice tips on both tuning your regular storage, as your<br />
GFS setup but also the tuning parameters for MySQL Cluster</p>
<p>I was also really happy to see the Appendixes on the basic installation where he advocates the use of Cobbler , Kickstart and LVM ..</p>
<p>One of the better books I read the past couple of years .. certainly the best book from Packt so far , I hope there is more quality stuff coming from that direction !</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
<li class="comment_comments last"><a href="../../../high-availability-mysql-cookbook-review/index.html#comments" title="Jump to the first comment of this posting.">4 comments</a></li>
</ul></div>
</div>
<div id="node-960" class="node teaser blog cal">
    <acronym class="calendar published" title="2009-11-18T21:05:47+01:00">
  <span class="month">Nov</span>
  <span class="day">18</span>
    <span class="year">2009</span>
    </acronym>
    <h2 class="title"><a href="../../../got-interviewed/index.html">Got Interviewed</a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_437 first"><a href="../437/index.html" rel="tag" title="">dnsproblem</a></li>
<li class="taxonomy_term_484"><a href="../484/index.html" rel="tag" title="">drupal</a></li>
<li class="taxonomy_term_449"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_562"><a href="../562/index.html" rel="tag" title="">linux-ha</a></li>
<li class="taxonomy_term_458"><a href="../458/index.html" rel="tag" title="">mysql</a></li>
<li class="taxonomy_term_1336"><a href="../../../category/pacemaker/index.html" rel="tag" title="">pacemaker</a></li>
<li class="taxonomy_term_439"><a href="../439/index.html" rel="tag" title="">puppet</a></li>
<li class="taxonomy_term_672"><a href="../672/index.html" rel="tag" title="">virtualization</a></li>
<li class="taxonomy_term_470 last"><a href="../470/index.html" rel="tag" title="">xen</a></li>
</ul></span>
        </div>
  <div class="content"><p>by <a href="http://www.johnmwillis.com/devopsdays/devopsdays-09-interview-with-kris-buytaert/">@botchagalupe</a><br />
on Virtualization, Open Source tools and DNS Problems</p>
<p><embed src="http://blip.tv/play/AYGuxQoC" type="application/xshockwave-flash" width="480" height="390" allowscriptaccess="always" allowfullscreen="true"></embed></p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first last"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
</ul></div>
</div>
<div id="node-950" class="node teaser blog cal">
    <acronym class="calendar published" title="2009-10-16T20:53:13+02:00">
  <span class="month">Oct</span>
  <span class="day">16</span>
    <span class="year">2009</span>
    </acronym>
    <h2 class="title"><a href="../../../heartbeat-2-openais/index.html">Heartbeat 2 OpenAIS</a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_449 first"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_1315"><a href="../../../category/high-availability/index.html" rel="tag" title="">high availability</a></li>
<li class="taxonomy_term_1314 last"><a href="../../../category/openais/index.html" rel="tag" title="">openais</a></li>
</ul></span>
        </div>
  <div class="content"><p>While upgrading a pretty recent Heartbeat cluster to OpenAis earlier today I ran  into the following weird situation<br />
<div class="geshifilter"><pre class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Last updated: Fri Oct 16 08:50:03 2009</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Stack: openais</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Current DC: CO_NMS-1 - partition with quorum</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Version: 1.0.5-462f1569a43740667daf7b0f6b521742e9eb8fa7</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">4 Nodes configured, 2 expected votes</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">1 Resources configured.</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">============</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Online: [ CO_NMS-1 CO_NMS-2 ]</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">OFFLINE: [ co_nms-1 co_nms-2 ]</div></li></ol></pre></div></p>
<p>or <div class="geshifilter"><pre class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">crm(live)node# show</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">co_nms-1(5c48ab4f-767f-e2dc-20ec-5969cddad152): normal</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">co_nms-2(922ff786-eca9-bed0-d79d-8222727a2c5b): normal</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">CO_NMS-1: normal</div></li><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">CO_NMS-2: normal</div></li></ol></pre></div></p>
<p>Whohoo.. OpenAIS must have realized I have upperase and lowercase cores :)</p>
<p>Funny to see .. but quickly solved..</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first last"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
</ul></div>
</div>
<div id="node-869" class="node teaser blog cal">
    <acronym class="calendar published" title="2009-02-02T22:00:36+01:00">
  <span class="month">Feb</span>
  <span class="day">02</span>
    <span class="year">2009</span>
    </acronym>
    <h2 class="title"><a href="../../../everything-fine-whitespace-problem/index.html">Everything is a fine whitespace problem ... </a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_449 first"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_562"><a href="../562/index.html" rel="tag" title="">linux-ha</a></li>
<li class="taxonomy_term_1178"><a href="../../../category/whitespace/index.html" rel="tag" title="">whitespace</a></li>
<li class="taxonomy_term_1177 last"><a href="../../../category/xml/index.html" rel="tag" title="">xml</a></li>
</ul></span>
        </div>
  <div class="content"><p>Couple of days ago I was working on a Linux Heartbeat v2 setup.<br />
Upon inserting an XML snippet into the cib  cib-adm started eating memory fast until the oom killer kicked in.</p>
<p>The environment  was running a fairly old heartbeat-2.0.8 version so I upgraded to  heartbeat-2.1.4-2.1  and there I got a nice warning that my XML sintax wasn't correct.</p>
<p>There was a whitespace in the XML syntax.</p>
<p><div class="geshifilter"><pre class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&lt;expression attribute=&quot;#replicationvalue&quot; id=&quot;is_lagged&quot; operation =&quot;gt&quot;  ... &gt;&lt;</div></li></ol></pre></div></p>
<p>Removing the  whitespace solves the problem, also on the older version.  So the problem is already fixed upstream.. but you might run into it anyhow.</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
<li class="comment_comments last"><a href="../../../everything-fine-whitespace-problem/index.html#comments" title="Jump to the first comment of this posting.">2 comments</a></li>
</ul></div>
</div>
<div id="node-730" class="node teaser blog cal">
    <acronym class="calendar published" title="2008-09-24T17:27:26+02:00">
  <span class="month">Sep</span>
  <span class="day">24</span>
    <span class="year">2008</span>
    </acronym>
    <h2 class="title"><a href="../../../bug-ifconfig/index.html">Bug in ifconfig ? </a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_449 first"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_1032"><a href="../1032/index.html" rel="tag" title="">ifconfig</a></li>
<li class="taxonomy_term_1031"><a href="../1031/index.html" rel="tag" title="">ip</a></li>
<li class="taxonomy_term_562"><a href="../562/index.html" rel="tag" title="">linux-ha</a></li>
<li class="taxonomy_term_599 last"><a href="../599/index.html" rel="tag" title="">opensource</a></li>
</ul></span>
        </div>
  <div class="content"><p>So earlier this week I ran into the weirdest problem with Linux-HA.  Heartbeat was happily adding an IP address as an active resource so one of my nodes when needed, but upon removal it failed to remove the IP from the stack.  Further debugging learned that the Heartbeat scripts claimed the ip wasn't on the actual stack.</p>
<p>It was.. but it the output from ifconfig was different from what it expected it to be.</p>
<p>Heartbeat checks the output of ifconfig and expects to find the IP address it added itselve to be on a :0 or similar interface.     Now ifconfig only seems output 8 characters for the interface name  Which means that when you have an interface called eth0:0 the output perfectly lists it and heartbea<br />
t is smart enough to remove the ip again when the node goes to standby.  If however you have   a vlan with 3 digits on a bond interface Heartbeat will add :0 to bond0.129  , the Heartbeat resource will add the ip address perfectly but opon checking all the :0 interfaces the bond0.129:0 interface won't be parsed as ifconfig outputs it as bond0.129 , hence resulting in a potential painfull situation where 2 nodes still share an IP address.</p>
<p>So where's the actual problem ifconfig, or heartbeat,   I'd say both, but the easiest fix will be in  Heartbeat,  afterall there are other preferred ways of adding an ip addres to an interface. ip addr add comes to mind :)</p>
<p>So I filed a <a href="http://developerbugs.linux-foundation.org/show_bug.cgi?id=1968" rel="nofollow">bug report</a> :)</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
<li class="comment_comments last"><a href="../../../bug-ifconfig/index.html#comments" title="Jump to the first comment of this posting.">1 comment</a></li>
</ul></div>
</div>
<div id="node-585" class="node teaser blog cal">
    <acronym class="calendar published" title="2008-02-06T19:56:36+01:00">
  <span class="month">Feb</span>
  <span class="day">06</span>
    <span class="year">2008</span>
    </acronym>
    <h2 class="title"><a href="../../../node/585/index.html">It&#039;s February again</a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_449 first"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_584"><a href="../584/index.html" rel="tag" title="">oreilly</a></li>
<li class="taxonomy_term_769"><a href="../769/index.html" rel="tag" title="">raskas</a></li>
<li class="taxonomy_term_470 last"><a href="../470/index.html" rel="tag" title="">xen</a></li>
</ul></span>
        </div>
  <div class="content"><p>It seems like for the past <a href="http://www.oreillynet.com/pub/au/1737" rel="nofollow">4 years</a> February is the month that  O'Reilly really loves me and decides to publish one of my articles.</p>
<p>This years version was cowritten together with my collegue <a href="http://www.raskas.be/blog/" rel="nofollow">Johan Huysmans</a> and tackles the creation of <a href="http://www.onlamp.com/pub/a/onlamp/2008/02/05/using-xen-for-high-availabilty-clusters.html" rel="nofollow">Highly Available Gateways</a></p>
<p>Altough the every HA situation is different and this is a pretty easy setup it's a good start for other setups.</p>
<p>Enjoy the read</p>
<p>PS.  Yes I know , in 2006 I also had a January article :)</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first last"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
</ul></div>
</div>
<div id="node-478" class="node teaser blog cal">
    <acronym class="calendar published" title="2007-10-17T12:54:35+02:00">
  <span class="month">Oct</span>
  <span class="day">17</span>
    <span class="year">2007</span>
    </acronym>
    <h2 class="title"><a href="../../../node/478/index.html">Virtual Machine Replication</a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_561 first"><a href="../561/index.html" rel="tag" title="">clustering</a></li>
<li class="taxonomy_term_560"><a href="../560/index.html" rel="tag" title="">dreaming</a></li>
<li class="taxonomy_term_449"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_562"><a href="../562/index.html" rel="tag" title="">linux-ha</a></li>
<li class="taxonomy_term_464"><a href="../464/index.html" rel="tag" title="">vapourware</a></li>
<li class="taxonomy_term_563"><a href="../563/index.html" rel="tag" title="">virtual iron</a></li>
<li class="taxonomy_term_555"><a href="../555/index.html" rel="tag" title="">vmware</a></li>
<li class="taxonomy_term_470 last"><a href="../470/index.html" rel="tag" title="">xen</a></li>
</ul></span>
        </div>
  <div class="content"><p>I don't know on which planet I have been for the past couple of years , days  or hours  but since when do <a href="http://blogs.zdnet.com/virtualization/?p=256" rel="nofollow"><br />
VMware’s Vmotion, XenSource’s Xenmotion or Virtual Iron’s Virtual Iron support  Replication ?  </a></p>
<p>Live Migration yes, but Replication ,  No.  </p>
<p>I discussed this kind of technologies  with Mark and Vincent , Moshe and others already  a zillion times..  Continuously mirroring or realtime replication of a virtual machine is really difficult to do.  And I haven't heard from a working  scalable solution yet .. (Shared Memory issues such as we had with openMosix  still are amongst the issue to be tackled) </p>
<p>Live Replication would mean that you mirror the full state of your virtual machine realtime to another running virtual machine.  Every piece of disk/memory and screen you are using has to be replicated to the other side of the wire realtime.  Yes you can take snapshots of filesystems and checkpoints of virtual machines.  But continuous checkpointing over the network  , I'd love to see that.. (outside of a lab)</p>
<p>So with a promise  like that .. our good friends the CIO will be dreaming and the vendors will be blamed for not delivering what was promised to them.</p>
<p>But on the subject of using just Live Migration features as an alternative for a real High Availability solution  , I know different vendors are singing this song,  but it's a bad one.</p>
<p>Using Live migration in your infrastructure will give you the opportunity to move your applications away from a bad behaving machine when you notice it starts behaving badly, hence giving you a better overall uptime.  If however you don't notice the machine is failing, or if it just suddenly stops working, or if your application crashes you are out of luck.<br />
Live migration won't work anymore since you are to late,  you can't migrate a machine that's dead.  The only thing you can do is quickly redeploy your virtual machine on another node, which for me doesn't really qualify as a Clustered or HA solution.</p>
<p>Real HA looks at all the aspects of an application,  the state of the application, the state of the server it is running on and the state of the network it is connected to.  It has an alternative ready if any of these aspects fail.  Session data is replicated,  data storage is done redundantly and your network has multiple paths.    If your monitoring decides something went wrong another alternative should take over with no visible interruption for the end user.  You don't have to wait till your application is restarted on the other side of the network, you don't have to wait till your virtual machine is rebooted, your filesystems are rechecked and your database has recovered no it happens right away .</p>
<p>But Virtual Machine Replication as an alternative for HA ?  I'd call that wishfull thinking and vapourware today</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
<li class="comment_comments last"><a href="../../../node/478/index.html#comments" title="Jump to the first comment of this posting.">2 comments</a></li>
</ul></div>
</div>
<div id="node-442" class="node teaser blog cal">
    <acronym class="calendar published" title="2007-09-05T10:56:26+02:00">
  <span class="month">Sep</span>
  <span class="day">05</span>
    <span class="year">2007</span>
    </acronym>
    <h2 class="title"><a href="../../../node/442/index.html">LinuxConference Europe 2007  5/X</a></h2>
      <div class="submitted">
          <span class="author">By: Kris Buytaert</span>
              <span class="taxonomy">Tags: <ul class="links inline"><li class="taxonomy_term_428 first"><a href="../428/index.html" rel="tag" title="">cambridge</a></li>
<li class="taxonomy_term_449"><a href="../449/index.html" rel="tag" title="">ha</a></li>
<li class="taxonomy_term_475 active"><a href="index.html" rel="tag" title="" class="active">heartbeat</a></li>
<li class="taxonomy_term_476"><a href="../476/index.html" rel="tag" title="">linuxconf.eu.2007</a></li>
<li class="taxonomy_term_429"><a href="../429/index.html" rel="tag" title="">linuxconference</a></li>
<li class="taxonomy_term_450"><a href="../450/index.html" rel="tag" title="">lmb</a></li>
<li class="taxonomy_term_448"><a href="../448/index.html" rel="tag" title="">tutorial</a></li>
<li class="taxonomy_term_427 last"><a href="../427/index.html" rel="tag" title="">ukuug</a></li>
</ul></span>
        </div>
  <div class="content"><p>So today is the last day of LinuxConference Europe ,  down the stairs in the same building there a bunch of weirdos sitting at round tables for some highly elite and secret meeting. , also known as the KernelSummit.</p>
<p>I just heard someone say that they are figuring out which new bug they are planning to introduce into the new kernels. </p>
<p>I`m in LMB's tutorial on Linux HA,  so I`ll be musing about one of my favourite topics today :)<br />
Or I`ll just pay attention ;)</p>
<p>I`m wondering why Lars just modified one of his slides... maybe I`ll ask him over Lunch...</p>
</div>
  <div class="links">&raquo; <ul class="links inline"><li class="blog_usernames_blog first last"><a href="../../../blogs/kris-buytaert/index.html" title="Read Kris Buytaert&#039;s latest blog entries.">Kris Buytaert&#039;s blog</a></li>
</ul></div>
</div>
</div>
</div>

</div>

<div id="footer" class="footer">
  No really .. everything is a funky DNS problem , you'll realise I`m right pretty soon !   
  <p class="credits">Powered by <a href="http://www.drupal.org/">Drupal</a> and the <a href="http://www.drupal.org/project/barlow">Barlow</a> theme by <a href="http://egonbianchet.net/">Egon Bianchet</a>.</p>
</div>

</div>

</body>

<!-- Mirrored from 127.0.0.1:8080/blog/taxonomy/term/475 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 01 Sep 2017 19:42:35 GMT -->
</html>
